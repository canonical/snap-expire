name: CI

on:
  push:
    branches:
      - master
  pull_request:
    branches:
      - master

jobs:
  poll:
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v4
      - shell: sh
        env:
          CHROMIUM: ${{ secrets.CHROMIUM }}
        run: |
          set -x
          sudo snap install surl
          sudo apt install -y jq tree
          snap=chromium
          2>/dev/null surl #Creates ~/snap/surl necessary for next step
          printf %s "$CHROMIUM" > "$HOME/snap/surl/common/$snap.surl"
          ./snap-expire -n 10 -a "$snap" "$snap"
